<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>UX-Interview (RU)</title>
  <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.4/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="min-h-screen flex items-center justify-center bg-neutral-50">
  <!--
    Версия для России с использованием Cloudflare прокси
    Основное отличие - атрибут api-base-url="/api/convai"
  -->
  <elevenlabs-convai 
    id="widget" 
    agent-id="agent_01jxv44dq3f09afkz7n7m7mxac"
    api-base-url="/api"
    inference-api-base-url="/api">
  </elevenlabs-convai>

  <script>
    const widget = document.getElementById('widget');
    
    // Set base URLs via JS for robustness, ensuring all API calls go through the proxy
    widget.apiBaseUrl = '/api';
    widget.inferenceApiBaseUrl = '/api';
    
    // Берём параметры URL
    const p = new URLSearchParams(window.location.search);

    // agent_id можно передать параметром, иначе используется тот, что в атрибуте
    const agentId = p.get('agent_id');
    if (agentId) {
      widget.setAttribute('agent-id', agentId);
    }

    // Собираем dynamic variables (любой параметр, кроме agent_id)
    const dyn = {};
    p.forEach((value, key) => {
      if (key !== 'agent_id') {
        dyn[key] = value;
      }
    });
    // Записываем их в атрибут dynamic-variables
    widget.setAttribute('dynamic-variables', JSON.stringify(dyn));
  </script>
</body>
</html>
